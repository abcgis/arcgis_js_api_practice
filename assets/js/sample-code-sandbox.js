/*! ArcGIS API for JavaScript 4.12 | Copyright (c) 2019 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};require(["calcite-web","eligrey/FileSaver","mousetrap","dojo/_base/connect","dojo/_base/event","dojo/dom-construct","dojo/dom-style","dojo/Deferred","dojo/has","dojo/on","dojo/query","esri/config","esri/core/urlUtils","esri/request","@dojo/framework/has/has!es6-symbol?prettier/prettier-helper:dojo/has","dojo/NodeList-dom","dojo/domReady!"],function(r,n,o,t,a,s,i,c,d,l,m,e,u,f,p){var b=14.11,g=!1,v={title:"My first sample",editors:"100",html:"",layout:"left"},h=void 0,y=[],S=void 0,x=void 0,C=void 0,w={},j=void 0,O=void 0,k=void 0,z=!1,E=!1,q=void 0,K=!1,F=!1,T="https://codepen.io/pen/define/",A="codepen",D=!0;window.jsshare=function(e){"jsbin"===e?A="jsbin":"codepen"===e&&(A="codepen"),localStorage.jsShareType=A};var L,V=void(window.sandboxOutputRefreshDelayInMilliseconds=0),M=void 0,_=void 0,H=void 0,I=void 0,N=void 0,P=void 0,R=void 0,B=void 0;function J(o){var e=o.match(/issMeshUrl = ".+?"/g);if(e&&(e=e.filter(function(e){return-1===e.indexOf("//")})).forEach(function(e){var n=e.split('"')[1];o=o.replace(n,C+"/"+n)}),(e=o.match(/url = ".+?"/g))&&(e=e.filter(function(e){return-1===e.indexOf("//")})).forEach(function(e){var n=e.split('"')[1];o=o.replace(n,C+"/"+n)}),(e=o.match(/image: ".+?"/g))&&(e=e.filter(function(e){return-1===e.indexOf("//")})).forEach(function(e){var n=e.split('"')[1];o=o.replace(n,C+"/"+n)}),(e=o.match(/url: ".+?"/g))&&(e=e.filter(function(e){return-1===e.indexOf("//")})).forEach(function(e){var n=e.split('"')[1];o=o.replace(n,C+"/"+n)}),(e=o.match(/src='.+?'/g))&&(e=e.filter(function(e){return-1===e.indexOf("//")})).forEach(function(e){var n=e.split("'")[1];o=o.replace(n,C+"/"+n)}),(e=o.match(/getUniqueValueSymbol\(".+?"/g))&&(e=(e=e.filter(function(e){return-1===e.indexOf("//")})).filter(function(e){return-1===e.indexOf("{")})).forEach(function(e){var n=e.split('"')[1];o=o.replace(n,C+"/"+n)}),(e=o.match(/src=".+?"/g))&&(e=(e=e.filter(function(e){return-1===e.indexOf("//")})).filter(function(e){return-1===e.indexOf("{")})).forEach(function(e){var n=e.split('"')[1];o=o.replace(n,C+"/"+n)}),(e=o.match(/"dojo\/text!.+?"/g))&&(e=e.filter(function(e){return-1===e.indexOf("//")})).forEach(function(e){var n=e.split('"')[1];o=o.replace(n,"dojo/text!"+C+"/brightest.txt")}),/layers-scenelayerview-query/.test(C)){var n=/<img[^>]*>/im,t=new RegExp(C+"/");if(n.test(o)){var a=o.match(n)[0].replace(t,"");o=o.replace(n,a)}}return o}function U(e){g&&console&&console.log&&console.log(Array.prototype.slice.call(arguments))}function G(){N.removeAttr("style"),R.removeAttr("style")}function W(){F&&X(),R.toggleClass("sandbox-container-minimized"),N.toggleClass("sandbox-output-maximized"),V.toggleClass("sandbox-container-minimized"),G(),h.resize(!0),K=!K}function X(){K&&W(),R.toggleClass("sandbox-container-maximized"),N.toggleClass("sandbox-output-minimized"),V.toggleClass("sandbox-container-minimized"),G(),h.resize(!0),F=!F}function Y(){document.location=H.attr("data-sample-description-url")[0]}function $(){U("saveFile");try{if(!!new Blob){var e=new Blob([h.getSession().getValue()],{type:"text/plain;charset='"+document.characterSet+"'"});n(e,x+".html")}}catch(e){console.log("Download is not supported for %s",navigator.userAgent)}}function Q(){U("openJSShare");var e=window.open("about:blank",[n(2),n(1),n(1),n(1),n(3)].join("-"));function n(e){for(var n="",o=0;o<e;o++)n+=(65536*(1+Math.random())|0).toString(16).substring(1);return n}var o=function(e){var n=e,o=/<title>[^<]*<\/title>/im,t=e.match(o),a=t?t[0]:"",s=a.replace(/<\/?title>/gim,"");if(v.title=s,a&&""!==a){var i=C.match(/[-\w]*(?=\/live(\/index\.html)?)/im),r=i?i[0]:"sample",c="https://developers.arcgis.com/javascript/latest/sample-code/"+r+"/index.html",d="";"jsbin"===A&&(d+='<meta name="description" content="['+s+']">\n  '),d+="\x3c!--\n     ArcGIS API for JavaScript, https://js.arcgis.com\n     For more information about the {{ sample_name }} sample,\n     read the original sample description at developers.arcgis.com.\n     {{ sample_url }}\n     --\x3e\n".replace(/{{\ssample_name\s}}/,r).replace(/{{\ssample_url\s}}/,c)+a,n=e.replace(o,d)}var l=n;return"function"==typeof p.format&&(l=p.format(n,p.esriDefaultOptions)),l}(h.getSession().getValue());localStorage&&localStorage.jsShareType&&(A=localStorage.jsShareType);var t=["html"],a=e.document.createElement("form"),s=void 0;"jsbin"===A?T="https://jsbin.com?html,output":"codepen"===A&&(T="https://codepen.io/pen/define/"),a.setAttribute("target","_self"),a.setAttribute("method","post"),a.setAttribute("action",T),a.style.display="none";for(var i=0;i<t.length;i++)s=e.document.createElement("input"),a.appendChild(s),s.type="hidden","jsbin"===A?(s.name=t[i],s.value=encodeURIComponent(o)):"codepen"===A?(v.html=o.replace(/<!DOCTYPE html>\n?/i,""),s.name="data",s.value=JSON.stringify(v)):s.value="";e.document.body.appendChild(a),a.submit()}function Z(e){a.stop(e),V.addClass("resizing"),P.addClass("resizing");var n=i.get("wrapper","width");var o=l(window,"mousemove",function(e){a.stop(e),50<e.pageX&&e.pageX+70<n&&(function(e,n){R[0].style.right=n-e+"px",N[0].style.left=e+"px"}(e.pageX+11,n),h.resize(!0))});l.once(parent.document,"mouseup",function(e){V.removeClass("resizing"),P.removeClass("resizing"),t.disconnect(o)})}function ee(){U("updateSandboxOutput"),B.addClass("is-active"),(P=m(".js-sandbox-iframe"))&&s.destroy(P[0]),k&&t.disconnect(k);var e=s.create("iframe",{class:"sandbox-iframe js-sandbox-iframe",allowfullscreen:"true"},N[0]);k=l(e,"load",function(){P=m(".js-sandbox-iframe"),setTimeout(function(){B.removeClass("is-active"),I.removeClass("btn-disabled")},3e3)}),U("sandboxIsLoaded");var n=e.contentWindow?e.contentWindow:e.contentDocument.document?e.contentDocument.document:e.contentDocument;d("ie")?(n.contents=h.getSession().getValue(),e.src="javascript:window['contents']"):(n.document.open(),n.document.write(h.getSession().getValue()),n.document.close())}(L=new c,r.init(),L.resolve({success:!0}),L.promise).then(function(){var e=new c;return U("bindEventHandlers"),H=m(".js-btn-sample-description"),_=m(".js-btn-save-file"),M=m(".js-btn-jsshare"),I=m(".js-btn-refresh"),R=m(".js-sandbox-container"),V=m(".js-sandbox-handle"),N=m(".js-sandbox-output"),B=m(".js-loader"),H.on("click",Y),_.on("click",$),M.on("click",Q),I.on("click",ee),m(".js-btn-sandbox-keyboard-shortcuts").on("click",function(){r.bus.emit("modal:open",{id:"modal-keyboard-shortcuts"})}),V.on("mousedown",Z),l(window,"resize",G),e.resolve({success:!0}),e.promise}).then(function(){var e=new c;return S=document.documentElement.getAttribute("data-platform"),/mac/i.test(S)&&r.addClass(r.findElements("body")[0],"macintosh"),r.bus.on("keyboard:mousetrap",function(e){var n=e.event.key,o=e.combination;"?"===n?r.bus.emit("modal:open","modal-keyboard-shortcuts"):"s"===n&&"g s"===o?Y():"c"===n?(e.event.preventDefault(),h.isFocused()||h.focus()):"d"===n?$():"s"===n?Q():"Enter"!==n||"command+enter"!==o&&"ctrl+enter"!==o?"h"===n&&"t h"===o?W():"o"===n&&"t o"===o&&X():ee()}),o.bind(["g s","c","d","s","command+enter","ctrl+enter","t h","t o","?"],function(e,n){r.bus.emit("keyboard:mousetrap",{event:e,combination:n})}),e.resolve({success:!0}),e.promise}).then(function(){var e=new c;U("setSampleFolder");var n=u.urlToObject(document.location.href);n.query=n.query||{};var o=document.location.pathname.replace("sample-code/sandbox/index.html","");return C=n.query&&n.query.sample?(x=n.query.sample,H.attr("data-sample-description-url","../../sample-code/"+x+"/index.html"),document.title="Sandbox: "+x,document.location.protocol+"//"+document.location.host+o+"sample-code/"+n.query.sample+"/live"):o+"sample-code/intro-mapview/live",n.query&&n.query.hasOwnProperty("share")&&"false"===n.query.share&&(D=!1),e.resolve({success:!0}),e.promise}).then(function(){return U("fetchSandboxSampleCode"),f(C+"/index.html",{responseType:"text"}).then(function(e){return U("handleSample"),j=J(e.data),O=J(e.data),H.toggleClass("btn-disabled"),{result:"success",code:j}})}).then(function(){var e=new c;U("startEditor"),ace.config.set("workerPath","../../../assets/js/libs/ace");var n=m(".js-sandbox-editor")[0];if((h=ace.edit(n)).$blockScrolling=1/0,h.setPrintMarginColumn(0),h.setTheme("ace/theme/esri"),h.getSession().setTabSize(2),h.getSession().setUseSoftTabs(!0),h.getSession().setMode("ace/mode/html_esri"),h.getSession().setUseWorker(!0),h.setOptions({enableLinking:!0,enableBasicAutocompletion:!0,wrap:!0}),q=b,localStorage){if(z=!0,function(){var e="";for(var n in window.localStorage)localStorage.hasOwnProperty(n)&&(e+=window.localStorage[n]);return e?3+16*e.length/8192+" KB":"Empty (0 KB)"}(),localStorage.sandboxFontSize?localStorage.sandboxFontSize&&(q=parseInt(localStorage.sandboxFontSize),h.setFontSize(q)):localStorage.sandboxFontSize=q,localStorage.sandboxSourceCode)if((w=JSON.parse(localStorage.sandboxSourceCode)).hasOwnProperty(x)){var o=w[x];j=o,"function"==typeof p.format&&(j=p.format(o,p.esriDefaultOptions)),h.getSession().setValue(j),document.querySelector(".js-sandbox-editor").appendChild(document.createElement("div")).setAttribute("class","sandbox-revert-message-container");var t=document.querySelector(".sandbox-revert-message-container");t.innerHTML='<div class="alert is-active"><div class="inline-block margin-right-2">\n            <span class="avenir-bold">NOTE</span>: \n            This is a saved version, <a class="btn-link js-sandbox-revert-link">revert to the original?</a></div>\n            <button class="alert-close js-sandbox-revert-message-close">\n              <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" class="svg-icon">\n                <path d="M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/>\n              </svg>\n            </button>\n          </div>';var a=document.querySelector(".js-sandbox-revert-message-close");r.addEvent(a,"click",function(){r.hasClass(t,"hide")||r.addClass(t,"hide")});var s=document.querySelector(".js-sandbox-revert-link");r.addEvent(s,"click",function(){j=O,E=!0,setTimeout(function(){h.getSession().setValue(O),ee()},1500),r.hasClass(t,"hide")||r.addClass(t,"hide")})}else h.getSession().setValue(j);else localStorage.sandboxSourceCode="{}",h.getSession().setValue(j);localStorage.sandboxKeybindings||(localStorage.sandboxKeybindings="ace")}else h.getSession().setValue(j);h.on("change",function(e){y.push(e),function(e){z&&"object"===(void 0===w?"undefined":_typeof(w))&&(j=h.getSession().getValue(),w[x]=j,localStorage.sandboxSourceCode=JSON.stringify(w)),y=[],0<window.sandboxOutputRefreshDelayInMilliseconds&&setTimeout(function(){ee()},window.sandboxOutputRefreshDelayInMilliseconds),E&&"insert"===e.action&&(E=!1,delete w[x],localStorage.sandboxSourceCode=JSON.stringify(w))}(e)}),_.removeClass("btn-disabled"),D&&M.removeClass("btn-disabled");var i={current:"ace",ace:null,vim:void 0};return ace.config.loadModule("ace/keyboard/vim",function(e){i.vim=e.handler,e.CodeMirror.Vim.defineEx("write","w",function(e,n){e.ace.execCommand("sandboxSaveCommand")}),localStorage.sandboxKeybindings&&"vim"===localStorage.sandboxKeybindings&&"ace"===i.current&&(h.setKeyboardHandler(i.vim),i.current="vim")}),h.commands.removeCommand({name:"gotoline",bindKey:{win:"Ctrl-L",mac:"Command-L"}}),h.commands.addCommand({name:"gotoline",bindKey:{win:"Ctrl-Alt-G",mac:"Option-Command-G"},exec:function(e,n){"number"!=typeof n&&(n=parseInt(prompt("Enter line number:"),10)),isNaN(n)||e.gotoLine(n)},readOnly:!0}),h.commands.addCommand({name:"sandboxSaveCommand",bindKey:{win:"Ctrl-Enter",mac:"Command-Enter"},exec:function(e){ee()}}),h.commands.addCommand({name:"sandboxKeybindingCommand",bindKey:{win:"Ctrl-K",mac:"Command-K"},exec:function(e){"ace"===i.current?(e.setKeyboardHandler(i.vim),i.current="vim"):(e.setKeyboardHandler(i.ace),i.current="ace")}}),h.commands.addCommand({name:"sandboxCommentLinesCommand",bindKey:{win:"Ctrl-/",mac:"Command-/"},exec:function(e){e.toggleCommentLines()}}),h.commands.addCommand({name:"sandboxPrettierCommand",bindKey:{win:"Ctrl-Alt-L",mac:"Option-Command-L"},exec:function(e){!function(){var e=h.getSession().getValue(),n=e;"function"==typeof p.format&&(n=p.format(e,p.esriDefaultOptions)),h.getSession().setValue(n)}()}}),h.commands.addCommand({name:"sandboxToogleHTMLCommand",bindKey:{win:"Ctrl-1",mac:"Ctrl-1"},exec:function(e){W()}}),h.commands.addCommand({name:"sandboxToogleOutputCommand",bindKey:{win:"Ctrl-2",mac:"Ctrl-2"},exec:function(e){X()}}),h.commands.addCommand({name:"sandboxIncreaseFontCommand",bindKey:{win:"Ctrl-Shift-.",mac:"Command-Shift-."},exec:function(e){q++,e.setFontSize(q),18<(localStorage.sandboxFontSize=q)&&""===document.querySelector(".js-sandbox-editor").style.lineHeight&&(document.querySelector(".js-sandbox-editor").style.lineHeight=1.4)}}),h.commands.addCommand({name:"sandboxDecreaseFontCommand",bindKey:{win:"Ctrl-Shift-,",mac:"Command-Shift-,"},exec:function(e){q--,e.setFontSize(q),(localStorage.sandboxFontSize=q)<18&&""!==document.querySelector(".js-sandbox-editor").style.lineHeight&&(document.querySelector(".js-sandbox-editor").style.lineHeight="")}}),h.commands.addCommand({name:"sandboxResetFontCommand",bindKey:{win:"Ctrl-0",mac:"Command-0"},exec:function(e){e.setFontSize(b),q=b,localStorage&&delete localStorage.sandboxFontSize,document.querySelector(".js-sandbox-editor").style.lineHeight="",document.querySelector(".js-sandbox-editor").style.fontSize=""}}),h.commands.addCommand({name:"blur",bindKey:{win:"Shift-Esc",mac:"Shift-Esc"},exec:function(e){e.isFocused()&&e.blur()}}),h.on("linkClick",function(e){var n=e.token.value,o=n;if(/[0-9a-fA-F]{32}/.test(n))o="https://www.arcgis.com/home/item.html?id="+n,window.open(o,"_blank");else if(/esri(\/\w+)+/.test(n)){var t="developers.arcgis.com";/(localhost|esri\.com)/.test(document.location.hostname)&&(t=document.location.hostname),o="https://"+t+"/javascript/latest/api-reference/"+n.replace(/\//g,"-")+".html",window.open(o,"_blank")}else/esri-url-href/.test(e.token.type)&&window.open(n,"_blank")}),e.resolve({success:!0}),e.promise}).then(function(e){return ee(),e}).catch(function(e){console.log("failed",e)})});